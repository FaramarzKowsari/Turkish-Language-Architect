<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turkish Language Architect - Expert Engineering Edition</title>
    <style>
        :root {
            --primary: #3b82f6;
            --bg: #0f172a;
            --sidebar-bg: #111827;
            --card-bg: #1e293b;
            --text-main: #f8fafc;
            --text-dim: #94a3b8;
            --accent-root: #fbbf24;
            --accent-person: #c084fc;
            --success: #22c55e;
            --error: #ef4444;
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background-color: var(--bg); 
            color: var(--text-main); 
            margin: 0; 
            display: flex; 
            min-height: 100vh; 
            overflow-x: hidden;
        }

        .rtl { direction: rtl; }
        .ltr { direction: ltr; }

        #sidebar { 
            width: 300px; 
            background-color: var(--sidebar-bg); 
            border-right: 1px solid #1f2937; 
            border-left: 1px solid #1f2937;
            display: flex; 
            flex-direction: column; 
            position: fixed; 
            height: 100vh; 
            z-index: 50; 
            overflow-y: auto;
        }

        .sidebar-header { padding: 25px 20px; text-align: center; border-bottom: 1px solid #1f2937; }
        .lang-select-box { padding: 15px 20px; border-bottom: 1px solid #1f2937; }
        select { 
            width: 100%; padding: 12px; border-radius: 8px; 
            background: #1e293b; color: white; border: 1px solid #334155; 
            outline: none; cursor: pointer; font-size: 13px;
        }

        .nav-category {
            padding: 15px 20px 5px;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--primary);
            font-weight: 900;
            background: rgba(59, 130, 246, 0.03);
        }

        .nav-item { 
            padding: 10px 24px; display: flex; align-items: center; 
            color: var(--text-dim); text-decoration: none; cursor: pointer; 
            font-size: 12.5px; transition: 0.3s; border-left: 4px solid transparent; border-right: 4px solid transparent;
        }
        .nav-item:hover { background: rgba(59, 130, 246, 0.05); color: var(--text-main); }
        .nav-item.active { background: rgba(59, 130, 246, 0.1); color: var(--primary); font-weight: bold; }

        main { flex-grow: 1; padding: 40px; display: flex; justify-content: center; transition: margin 0.3s ease; }

        .card { 
            background-color: var(--card-bg); border-radius: 24px; padding: 40px; 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); border: 1px solid #334155; 
            width: 100%; max-width: 900px; position: relative; 
        }

        .quiz-header { display: flex; justify-content: space-between; margin-bottom: 30px; color: var(--primary); font-weight: bold; font-size: 13px; }
        .v-root { font-size: 64px; font-weight: 900; color: var(--accent-root); display: block; text-align: center; cursor: pointer; }
        .v-mean { color: var(--text-dim); font-size: 18px; margin: 15px 0; display: block; font-style: italic; text-align: center; }
        .v-person { font-size: 24px; color: var(--accent-person); font-weight: bold; text-align: center; display: block; margin-bottom: 20px; }

        .input-area { margin: 30px 0; text-align: center; }
        input { 
            width: 90%; padding: 20px; border-radius: 18px; border: 3px solid #334155; 
            background: #0f172a; color: #fff; text-align: center; font-size: 32px; 
            outline: none; transition: 0.4s; font-family: monospace; 
        }
        input.correct { border-color: var(--success); background: rgba(34, 197, 94, 0.05); }
        input.wrong { border-color: var(--error); }

        .btn-group { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .btn { padding: 15px 25px; border-radius: 14px; border: none; cursor: pointer; font-weight: bold; font-size: 13px; transition: 0.3s; }
        .btn-check { background: var(--primary); color: white; flex-grow: 1; max-width: 200px; }
        .btn-hint { background: #1e293b; color: #60a5fa; border: 1px solid #3b82f6; }
        .btn-reveal { background: #475569; color: white; }
        .btn-nav { background: #334155; color: white; width: 60px; font-size: 24px; display: flex; align-items: center; justify-content: center; }

        .expl-panel { 
            margin-top: 30px; padding: 25px; background: rgba(59, 130, 246, 0.05); 
            border-radius: 16px; display: none; line-height: 2; color: #cbd5e1; 
            text-align: justify; font-size: 15px; border-right: 4px solid var(--primary); border-left: 4px solid var(--primary);
            cursor: pointer;
        }

        .sample-usage-box { margin-top: 30px; padding: 25px; background: #111827; border-radius: 20px; border: 1px solid #334155; text-align: center; }
        .sample-tr { color: #38bdf8; font-size: 20px; font-weight: bold; cursor: pointer; display: block; margin-bottom: 12px; line-height: 1.6; }
        .sample-target { color: #94a3b8; font-size: 15px; display: block; text-align: justify; line-height: 1.8; border-top: 1px solid #334155; padding-top: 15px; }

        .author-photo-container { width: 150px; height: 150px; margin: 0 auto 20px; position: relative; }
        .author-photo { width: 100%; height: 100%; border-radius: 50%; border: 5px solid var(--primary); object-fit: cover; display: block; box-shadow: 0 10px 25px rgba(0,0,0,0.4); background-color: #334155; }
        .author-fallback { width: 100%; height: 100%; border-radius: 50%; background: var(--primary); display: flex; align-items: center; justify-content: center; font-size: 48px; font-weight: bold; color: white; border: 5px solid #334155; }

        @media (max-width: 992px) { #sidebar { width: 100%; height: auto; position: relative; border: none; } main { padding: 20px; margin: 0 !important; } }
    </style>
</head>
<body class="ltr">
    <aside id="sidebar">
        <div class="sidebar-header">
            <h2 id="ui-title" style="color:var(--primary); margin:0">Language Architect</h2>
            <p style="font-size:10px; color:var(--text-dim); margin-top:5px;">Faramarz Kowsari Lab</p>
        </div>
        
        <div class="lang-select-box">
            <select id="lang-selector" onchange="changeSourceLang(this.value)">
                <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                <option value="fa">ğŸ‡®ğŸ‡· Persian (ÙØ§Ø±Ø³ÛŒ)</option>
                <option value="es">ğŸ‡ªğŸ‡¸ Spanish (EspaÃ±ol)</option>
                <option value="de">ğŸ‡©ğŸ‡ª German (Deutsch)</option>
                <option value="fr">ğŸ‡«ğŸ‡· French (FranÃ§ais)</option>
                <option value="el">ğŸ‡¬ğŸ‡· Greek (Î•Î»Î»Î·Î½Î¹ÎºÎ¬)</option>
                <option value="zh">ğŸ‡¨ğŸ‡³ Chinese (ä¸­æ–‡)</option>
                <option value="ar">ğŸ‡¸ğŸ‡¦ Arabic (Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)</option>
            </select>
        </div>

        <nav class="nav-group" id="module-nav">
            <div class="nav-category" id="cat-tense">Tense</div>
            <div class="nav-item active" onclick="switchModule('past')" id="nav-past">Simple Past</div>
            <div class="nav-item" onclick="switchModule('present')" id="nav-present">Present Tense</div>
            <div class="nav-item" onclick="switchModule('future')" id="nav-future">Future Tense</div>

            <div class="nav-category" id="cat-aspect">Aspect</div>
            <div class="nav-item" onclick="switchModule('continuous')" id="nav-cont">Continuous (-yor)</div>
            <div class="nav-item" onclick="switchModule('aorist')" id="nav-aor">Aorist</div>

            <div class="nav-category" id="cat-mood">Mood</div>
            <div class="nav-item" onclick="switchModule('imperative')" id="nav-imp">Imperative</div>
            <div class="nav-item" onclick="switchModule('conditional')" id="nav-cond">Conditional</div>

            <div style="border-top: 1px solid #1f2937; margin: 10px 0;"></div>
            <div class="nav-item" onclick="fkTab('list')" id="nav-list">Master Database</div>
            <div class="nav-category" id="cat-help">Academy</div>
            <div class="nav-item" onclick="fkTab('academy')" id="nav-academy">ğŸ›ï¸ Academy (Help)</div>
            <div class="nav-item" onclick="fkTab('auth')" id="nav-auth">The Architect</div>
        </nav>
    </aside>

    <main id="main-area">
        <div class="card" id="sec-quiz" style="display:block">
            <div class="quiz-header">
                <span id="module-title-ui">Module</span>
                <span id="fk-info">Step 1</span>
                <span id="fk-score">Score: 0</span>
            </div>
            <div class="display-box">
                <span class="v-root" id="v-root" title="Click for Turkish Audio">GEL</span>
                <span class="v-mean" id="v-mean">...</span>
                <span class="v-person" id="v-pers">...</span>
            </div>
            <div class="input-area">
                <input type="text" id="fk-input" autocomplete="off" spellcheck="false" placeholder="...">
            </div>
            <div class="btn-group">
                <button class="btn btn-nav" onclick="move(-1)">â®</button>
                <button class="btn btn-check" id="ui-btn-check" onclick="check()">Check</button>
                <button class="btn btn-hint" id="ui-btn-hint" onclick="toggleHint()">Grammar Explanation</button>
                <button class="btn btn-reveal" id="ui-btn-reveal" onclick="reveal()">Show Answer</button>
                <button class="btn btn-nav" onclick="move(1)">â¯</button>
            </div>
            
            <div id="v-expl" class="expl-panel"></div>

            <div id="sample-box" class="sample-usage-box">
                <span id="ui-sample-tag" style="font-size: 10px; color: #475569; display: block; margin-bottom: 10px;">PRACTICAL USAGE:</span>
                <span class="sample-tr" id="sample-tr" title="Play Turkish Audio">...</span>
                <div id="sample-target" class="sample-target">...</div>
            </div>
        </div>

        <div class="card" id="sec-academy" style="display:none"><div class="academy-content" id="academy-body"></div></div>
        
        <div class="card" id="sec-list" style="display:none">
            <h2 id="list-title-ui" style="color:var(--primary)">Linguistic Database</h2>
            <div class="table-scroll"><table><thead><tr><th>#</th><th id="th-root">Root</th><th id="th-mean">Meaning</th><th id="th-ans">Answer</th><th>Audio</th></tr></thead><tbody id="list-body"></tbody></table></div>
        </div>

        <div class="card" id="sec-auth" style="display:none; text-align:center">
            <div class="author-photo-container">
                <img id="author-img" src="https://media.licdn.com/dms/image/v2/D4D03AQGBE3mihPZMzw/profile-displayphoto-shrink_200_200/profile-displayphoto-shrink_200_200/0/1705066609093?e=1772064000&v=beta&t=OBpBbgDTZSgHBg_E_UQaWRyS-jwCaC5tK9ry36PvOiQ" 
                     class="author-photo" 
                     alt="Faramarz Kowsari" 
                     onerror="this.style.display='none'; document.getElementById('author-fallback').style.display='flex';">
                <div id="author-fallback" class="author-fallback" style="display:none;">FK</div>
            </div>
            <h2 id="ui-author-name">Faramarz Kowsari</h2>
            <p id="ui-author-desc">PhD Researcher in AI & Language Architect</p>
            <div class="auth-btn-group">
                <a href="https://linkedin.com/in/faramarzkowsari" target="_blank" class="btn-social btn-linkedin" style="background:#0077b5; color:white; padding:10px 20px; border-radius:8px; text-decoration:none;">LinkedIn Profile</a>
                <a href="https://play.google.com/store/search?q=Faramarz_Kowsari&c=books" target="_blank" class="btn-social btn-googleplay" style="background:var(--primary); color:white; padding:10px 20px; border-radius:8px; text-decoration:none; margin-left:10px;">Google Play Books</a>
            </div>
        </div>
    </main>

    <script>
    (function(){
        let currentModule = 'past'; let sourceLang = 'en'; let cur = 0; let score = 0; let items = [];

        const i18n = {
            en: {
                title: "Language Architect", check: "Check Accuracy", hint: "Grammar Explanation", reveal: "Show Answer",
                past: "Simple Past", present: "Present Tense", future: "Future Tense", continuous: "Continuous (-yor)", aorist: "Aorist",
                catTense: "Tense", catAspect: "Aspect", catMood: "Mood", catHelp: "Academy",
                personNames: {Ben:"I", Sen:"You", O:"He/She", Biz:"We", Siz:"You (pl)", Onlar:"They"}, academy: "ğŸ›ï¸ Academy", sampleTag: "PRACTICAL USAGE:"
            },
            fa: {
                title: "Ù…Ø¹Ù…Ø§Ø± Ø²Ø¨Ø§Ù† ØªØ±Ú©ÛŒ", check: "Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª", hint: "ØªÙˆØ¶ÛŒØ­ Ú¯Ø±Ø§Ù…Ø±ÛŒ", reveal: "Ù†Ù…Ø§ÛŒØ´ Ù¾Ø§Ø³Ø®",
                past: "Ú¯Ø°Ø´ØªÙ‡ Ø³Ø§Ø¯Ù‡", present: "Ø²Ù…Ø§Ù† Ø­Ø§Ù„", future: "Ø²Ù…Ø§Ù† Ø¢ÛŒÙ†Ø¯Ù‡", continuous: "Ø§Ø³ØªÙ…Ø±Ø§Ø±ÛŒ (-yor)", aorist: "Ø¹Ø§Ø¯ØªÛŒ",
                catTense: "Ø²Ù…Ø§Ù†", catAspect: "Ø¬Ù†Ø¨Ù‡", catMood: "ÙˆØ¬Ù‡", catHelp: "Ø¢Ú©Ø§Ø¯Ù…ÛŒ",
                personNames: {Ben:"Ù…Ù†", Sen:"ØªÙˆ", O:"Ø§Ùˆ", Biz:"Ù…Ø§", Siz:"Ø´Ù…Ø§", Onlar:"Ø§ÛŒØ´Ø§Ù†"}, academy: "ğŸ›ï¸ Ø¢Ú©Ø§Ø¯Ù…ÛŒ", sampleTag: "Ú©Ø§Ø±Ø¨Ø±Ø¯ Ø¹Ù…Ù„ÛŒ (ØµÙˆØª ØªØ±Ú©ÛŒ):"
            },
            es: { title: "Arquitecto de Idiomas", check: "Verificar", hint: "ExplicaciÃ³n Gramatical", reveal: "Respuesta", personNames: {Ben:"Yo", Sen:"TÃº", O:"Ã‰l/Ella", Biz:"Nosotros", Siz:"Ustedes", Onlar:"Ellos"}, academy: "ğŸ›ï¸ Academia", sampleTag: "USO PRÃCTICO:" },
            de: { title: "Spracharchitekt", check: "PrÃ¼fen", hint: "Grammatik-ErklÃ¤rung", reveal: "Antwort", personNames: {Ben:"Ich", Sen:"Du", O:"Er/Sie", Biz:"Wir", Siz:"Ihr", Onlar:"Sie"}, academy: "ğŸ›ï¸ Akademie", sampleTag: "PRAKTISCHE ANWENDUNG:" },
            fr: { title: "Architecte de Langue", check: "VÃ©rifier", hint: "Explication Grammaticale", reveal: "RÃ©ponse", personNames: {Ben:"Je", Sen:"Tu", O:"Il/Elle", Biz:"Nous", Siz:"Vous", Onlar:"Ils"}, academy: "ğŸ›ï¸ AcadÃ©mie", sampleTag: "USAGE PRATIQUE:" },
            el: { title: "Î‘ÏÏ‡Î¹Ï„Î­ÎºÏ„Î¿Î½Î±Ï‚ Î“Î»Ï‰ÏƒÏƒÏÎ½", check: "ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚", hint: "Î“ÏÎ±Î¼Î¼Î±Ï„Î¹ÎºÎ® Î•Î¾Î®Î³Î·ÏƒÎ·", reveal: "Î‘Ï€Î¬Î½Ï„Î·ÏƒÎ·", personNames: {Ben:"Î•Î³Ï", Sen:"Î•ÏƒÏ", O:"Î‘Ï…Ï„ÏŒÏ‚", Biz:"Î•Î¼ÎµÎ¯Ï‚", Siz:"Î•ÏƒÎµÎ¯Ï‚", Onlar:"Î‘Ï…Ï„Î¿Î¯"}, academy: "ğŸ›ï¸ Î‘ÎºÎ±Î´Î·Î¼Î¯Î±", sampleTag: "Î Î¡Î‘ÎšÎ¤Î™ÎšÎ— Î§Î¡Î—Î£Î—:" },
            zh: { title: "è¯­è¨€æ¶æ„å¸ˆ", check: "æ£€æŸ¥", hint: "è¯­æ³•è§£é‡Š", reveal: "æ˜¾ç¤ºç­”æ¡ˆ", personNames: {Ben:"æˆ‘", Sen:"ä½ ", O:"ä»–/å¥¹", Biz:"æˆ‘ä»¬", Siz:"ä½ ä»¬", Onlar:"ä»–ä»¬"}, academy: "ğŸ›ï¸ å­¦é™¢", sampleTag: "å®é™…åº”ç”¨:" },
            ar: { title: "Ù…Ù‡Ù†Ø¯Ø³ Ø§Ù„Ù„ØºØ©", check: "ØªØ­Ù‚Ù‚", hint: "Ø´Ø±Ø­ Ù‚ÙˆØ§Ø¹Ø¯ÙŠ", reveal: "Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©", personNames: {Ben:"Ø£Ù†Ø§", Sen:"Ø£Ù†Øª", O:"Ù‡Ùˆ/Ù‡ÙŠ", Biz:"Ù†Ø­Ù†", Siz:"Ø£Ù†ØªÙ…", Onlar:"Ù‡Ù…"}, academy: "ğŸ›ï¸ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©", sampleTag: "Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠ:" }
        };

        window.fkSpeak = function(text, lang = 'tr-TR') {
            if (!window.speechSynthesis) return;
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(text);
            const voices = window.speechSynthesis.getVoices();
            let tLang = lang === 'fa' ? 'fa-IR' : (lang === 'en' ? 'en-US' : (lang === 'zh' ? 'zh-CN' : (lang === 'ar' ? 'ar-SA' : lang)));
            const bestVoice = voices.find(v => v.lang.includes(tLang) && (v.name.includes('Google') || v.name.includes('Natural'))) || voices.find(v => v.lang.includes(tLang));
            if (bestVoice) msg.voice = bestVoice;
            msg.lang = tLang; msg.rate = 0.85;
            window.speechSynthesis.speak(msg);
        };

        window.changeSourceLang = function(val) {
            sourceLang = val;
            document.body.className = (val === 'fa' || val === 'ar') ? 'rtl' : 'ltr';
            updateUI(); build();
        };

        function updateUI() {
            const t = i18n[sourceLang] || i18n['en'];
            document.getElementById('ui-title').innerText = t.title;
            document.getElementById('ui-btn-check').innerText = t.check;
            document.getElementById('ui-btn-hint').innerText = t.hint;
            document.getElementById('ui-btn-reveal').innerText = t.reveal;
            document.getElementById('nav-past').innerText = t.past || "Past";
            document.getElementById('nav-present').innerText = t.present || "Present";
            document.getElementById('nav-future').innerText = t.future || "Future";
            document.getElementById('nav-list').innerText = t.list || "Database";
            document.getElementById('nav-academy').innerText = t.academy || "Academy";
            document.getElementById('nav-auth').innerText = t.auth || "Author";
            document.getElementById('ui-sample-tag').innerText = t.sampleTag || "Practical Usage:";
            
            const sidebar = document.getElementById('sidebar');
            const mainArea = document.getElementById('main-area');
            if(sourceLang === 'fa' || sourceLang === 'ar') {
                sidebar.style.right = '0'; sidebar.style.left = 'auto'; sidebar.style.borderRight = 'none'; sidebar.style.borderLeft = '1px solid #1f2937';
                mainArea.style.marginRight = '300px'; mainArea.style.marginLeft = '0';
            } else {
                sidebar.style.left = '0'; sidebar.style.right = 'auto'; sidebar.style.borderLeft = 'none'; sidebar.style.borderRight = '1px solid #1f2937';
                mainArea.style.marginLeft = '300px'; mainArea.style.marginRight = '0';
            }
        }

        window.switchModule = function(mod) {
            currentModule = mod; cur = 0;
            fkTab('quiz'); build();
        };

        function generateDetailedHint(v, p, mod, ans) {
            const curI18n = i18n[sourceLang] || i18n['en'];
            const pName = (curI18n.personNames || i18n['en'].personNames)[p] || p;
            
            const hints = {
                en: `Engineering Analysis: We take the root "${v}". Based on vowel harmony, the "${mod}" operator is applied. For "${pName}", the structure compiles as "${ans}".`,
                fa: `ØªØ­Ù„ÛŒÙ„ Ù…Ù‡Ù†Ø¯Ø³ÛŒ: Ø±ÛŒØ´Ù‡ Â«${v}Â» Ø¨Ø§ ØªÙˆØ¬Ù‡ Ø¨Ù‡ Ù‚ÙˆØ§Ù†ÛŒÙ† Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ø§ØµÙˆØ§Øª Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø¨Ø±Ø§ÛŒ Ø¶Ù…ÛŒØ± Â«${pName}Â»ØŒ Ø³Ø§Ø®ØªØ§Ø± Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ù‡ ØµÙˆØ±Øª Â«${ans}Â» Ú©Ø§Ù…Ù¾Ø§ÛŒÙ„ Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯.`,
                es: `AnÃ¡lisis: Usamos la raÃ­z "${v}". SegÃºn la armonÃ­a vocÃ¡lica, aplicamos el operador "${mod}". Para "${pName}", la forma final es "${ans}".`,
                de: `Analyse: Wir nehmen den Stamm "${v}". Basierend auf der Vokalharmonie wird der Operator "${mod}" angewendet. FÃ¼r "${pName}" lautet das Ergebnis "${ans}".`,
                fr: `Analyse : Nous prenons la racine "${v}". En suivant l'harmonie vocalique, l'opÃ©rateur "${mod}" est appliquÃ©. Pour "${pName}", la forme finale est "${ans}".`,
                el: `Î‘Î½Î¬Î»Ï…ÏƒÎ·: Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Ï„Î· ÏÎ¯Î¶Î± "${v}". ÎœÎµ Î²Î¬ÏƒÎ· Ï„Î· Ï†Ï‰Î½Î·Ï„Î¹ÎºÎ® Î±ÏÎ¼Î¿Î½Î¯Î±, ÎµÏ†Î±ÏÎ¼ÏŒÎ¶ÎµÏ„Î±Î¹ Î¿ Ï„ÎµÎ»ÎµÏƒÏ„Î®Ï‚ "${mod}". Î“Î¹Î± Ï„Î¿ "${pName}", Î· Ï„ÎµÎ»Î¹ÎºÎ® Î¼Î¿ÏÏ†Î® ÎµÎ¯Î½Î±Î¹ "${ans}".`,
                zh: `åˆ†æï¼šæå–è¯æ ¹ "${v}"ã€‚æ ¹æ®å…ƒéŸ³å’Œè°è§„åˆ™åº”ç”¨ "${mod}" ç®—å­ã€‚å¯¹äºäººç§° "${pName}"ï¼Œæœ€ç»ˆå½¢å¼ä¸º "${ans}"ã€‚`,
                ar: `Ø§Ù„ØªØ­Ù„ÙŠÙ„: Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø°Ø± "${v}". Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§ÙÙ‚ Ø§Ù„ØµÙˆØªÙŠØŒ Ù†Ø·Ø¨Ù‚ Ø¹Ø§Ù…Ù„ "${mod}". Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù„Ø¶Ù…ÙŠØ± "${pName}"ØŒ Ø§Ù„ØµÙŠØºØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ù‡ÙŠ "${ans}".`
            };
            return hints[sourceLang] || hints['en'];
        }

        const verbContexts = {
            'Gel': { en: "to come", fa: "Ø¢Ù…Ø¯Ù†", scen: { tr: "Annem akÅŸam yemeÄŸi iÃ§in eve geliyor. Hepimiz heyecanla sofrada bekliyoruz. O her zaman harika yemekler hazÄ±rlar.", en: "My mother is coming home for dinner. We are all waiting excitedly at the table. She always prepares wonderful meals.", fa: "Ù…Ø§Ø¯Ø±Ù… Ø¨Ø±Ø§ÛŒ Ø´Ø§Ù… Ø¨Ù‡ Ø®Ø§Ù†Ù‡ Ù…ÛŒâ€ŒØ¢ÛŒØ¯. Ù‡Ù…Ù‡ Ù…Ø§ Ø¨Ø§ Ù‡ÛŒØ¬Ø§Ù† Ø³Ø± Ø³ÙØ±Ù‡ Ù…Ù†ØªØ¸Ø± Ù‡Ø³ØªÛŒÙ…. Ø§Ùˆ Ù‡Ù…ÛŒØ´Ù‡ ØºØ°Ø§Ù‡Ø§ÛŒ ÙÙˆÙ‚â€ŒØ§Ù„Ø¹Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯." }},
            'Git': { en: "to go", fa: "Ø±ÙØªÙ†", scen: { tr: "Babam her sabah erkenden iÅŸe gidiyor. O Ã§ok Ã§alÄ±ÅŸkan bir adamdÄ±r. Ailesi iÃ§in her gÃ¼n Ã§ok yorulur.", en: "My father goes to work early every morning. He is a very hard-working man. He gets very tired for his family every day.", fa: "Ù¾Ø¯Ø±Ù… Ù‡Ø± Ø±ÙˆØ² ØµØ¨Ø­ Ø²ÙˆØ¯ Ø¨Ù‡ Ø³Ø± Ú©Ø§Ø± Ù…ÛŒâ€ŒØ±ÙˆØ¯. Ø§Ùˆ Ù…Ø±Ø¯ Ø¨Ø³ÛŒØ§Ø± Ú©ÙˆØ´Ø§ÛŒÛŒ Ø§Ø³Øª. Ø§Ùˆ Ù‡Ø± Ø±ÙˆØ² Ø¨Ø±Ø§ÛŒ Ø®Ø§Ù†ÙˆØ§Ø¯Ù‡â€ŒØ§Ø´ Ø®ÛŒÙ„ÛŒ Ø®Ø³ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯." }},
            'Bak': { en: "to look", fa: "Ù†Ú¯Ø§Ù‡ Ú©Ø±Ø¯Ù†", scen: { tr: "Pencereden dÄ±ÅŸarÄ±ya dikkatle bakÄ±yorum. Kar yaÄŸÄ±yor ve her yer bembeyaz. DoÄŸa bugÃ¼n harika gÃ¶rÃ¼nÃ¼yor.", en: "I am looking out the window carefully. It's snowing and everywhere is pitch white. Nature looks wonderful today.", fa: "Ø¨Ø§ Ø¯Ù‚Øª Ø§Ø² Ù¾Ù†Ø¬Ø±Ù‡ Ø¨Ù‡ Ø¨ÛŒØ±ÙˆÙ† Ù†Ú¯Ø§Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ù…. Ø¨Ø±Ù Ù…ÛŒâ€ŒØ¨Ø§Ø±Ø¯ Ùˆ Ù‡Ù…Ù‡â€ŒØ¬Ø§ Ú©Ø§Ù…Ù„Ø§Ù‹ Ø³ÙÛŒØ¯ Ø§Ø³Øª. Ø·Ø¨ÛŒØ¹Øª Ø§Ù…Ø±ÙˆØ² ÙÙˆÙ‚â€ŒØ§Ù„Ø¹Ø§Ø¯Ù‡ Ø¨Ù‡ Ù†Ø¸Ø± Ù…ÛŒâ€ŒØ±Ø³Ø¯." }},
            'Oku': { en: "to read", fa: "Ø®ÙˆØ§Ù†Ø¯Ù†", scen: { tr: "KÃ¼tÃ¼phanede sessizce kitap okuyorum. Bu hikaye beni Ã§ok etkiledi. AkÅŸam bitirmeyi planlÄ±yorum.", en: "I am reading a book quietly in the library. This story moved me a lot. I plan to finish it tonight.", fa: "Ø¯Ø± Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø¨Ø§ Ø¢Ø±Ø§Ù…Ø´ Ú©ØªØ§Ø¨ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù†Ù…. Ø§ÛŒÙ† Ø¯Ø§Ø³ØªØ§Ù† Ø®ÛŒÙ„ÛŒ Ù…Ø±Ø§ ØªØ­Øª ØªØ§Ø«ÛŒØ± Ù‚Ø±Ø§Ø± Ø¯Ø§Ø¯. Ù‚ØµØ¯ Ø¯Ø§Ø±Ù… Ø§Ù…Ø´Ø¨ ØªÙ…Ø§Ù…Ø´ Ú©Ù†Ù…." }},
            'Yaz': { en: "to write", fa: "Ù†ÙˆØ´ØªÙ†", scen: { tr: "GÃ¼nlÃ¼ÄŸÃ¼me bugÃ¼nkÃ¼ anÄ±larÄ±mÄ± yazÄ±yorum. Ã‡ok maceralÄ± bir gÃ¼ndÃ¼. Gelecekte bunlarÄ± tekrar okuyacaÄŸÄ±m.", en: "I am writing today's memories in my diary. It was a very adventurous day. I will read these again in the future.", fa: "Ø®Ø§Ø·Ø±Ø§Øª Ø§Ù…Ø±ÙˆØ² Ø±Ø§ Ø¯Ø± Ø¯ÙØªØ±Ú†Ù‡ Ø®Ø§Ø·Ø±Ø§ØªÙ… Ù…ÛŒâ€ŒÙ†ÙˆÛŒØ³Ù…. Ø±ÙˆØ² Ø¨Ø³ÛŒØ§Ø± Ù¾Ø±Ù…Ø§Ø¬Ø±Ø§ÛŒÛŒ Ø¨ÙˆØ¯. Ø¯Ø± Ø¢ÛŒÙ†Ø¯Ù‡ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§ÛŒÙ†â€ŒÙ‡Ø§ Ø±Ø§ Ø®ÙˆØ§Ù‡Ù… Ø®ÙˆØ§Ù†Ø¯." }}
            // More verbs can be mapped here similarly...
        };

        function getLogic(v, p, mod) {
            let r = v.toLowerCase(); let lv = (r.match(/[aeÄ±ioÃ¶uÃ¼]/g)||['a']).pop();
            const sPresent = {Ben:'um',Sen:'sun',O:'',Biz:'uz',Siz:'sunuz',Onlar:'lar'};
            if(mod==='continuous') {
                if(r==='ye') r='yiyor'; else if(r==='de') r='diyor'; else if(r==='git') r='gidiyor'; else if(r.endsWith('a')||r.endsWith('e')) r=r.slice(0,-1)+('aÄ±'.includes(r.slice(-2,-1))?'Ä±':'i')+'yor';
                else { let h='i'; if('aÄ±'.includes(lv)) h='Ä±'; else if('ou'.includes(lv)) h='u'; else if('Ã¶Ã¼'.includes(lv)) h='Ã¼'; r+=h+'yor'; }
                return r + sPresent[p];
            }
            if(mod==='past') {
                let d = "fstkÃ§ÅŸhp".includes(r.slice(-1))?'t':'d'; let h='i'; if('aÄ±'.includes(lv)) h='Ä±'; else if('ou'.includes(lv)) h='u'; else if('Ã¶Ã¼'.includes(lv)) h='Ã¼';
                const s = {Ben:'m',Sen:'n',O:'',Biz:'k',Siz:h+'niz',Onlar:'lar'};
                return r+d+h+s[p];
            }
            return r;
        }

        function build() {
            items = [];
            const basePool = ['Gel','Bak','Git','Oku','Yaz','GÃ¶r','Sev','Yap','Ä°Ã§','Sor','Al','Bul','Ver','Uyu','KoÅŸ','GÃ¼l','Dur','Kapat','AÃ§','Dinle','Bil','Bitir','Ã‡alÄ±ÅŸ','Kal','SÃ¼r','YÃ¼z','Bin','Ä°n','UÃ§','TaÅŸÄ±','DÃ¼ÅŸÃ¼n','TanÄ±','Ã–zle','Sus','Otur','Kalk','Yat','YÄ±k','Giy','Dene','SeÃ§','Topla','Ara','GÃ¶nder','Getir','GÃ¶tÃ¼r','Kazan','Kaybet','Vur','Tut','BÄ±rak','KÄ±r','PiÅŸir','Tad','Kokla','Dokun','KaÃ§','Sakla','Gez','KÄ±z','KonuÅŸ','GÃ¼lÃ¼mse','HazÄ±rla','Unut','HatÄ±rla','DeÄŸiÅŸtir','YÃ¼rÃ¼','UÙ„Ø§Ø´','Salla','Tart','Bit','Seyret','Kaydet','Park et','Kabul et','Ä°ptal et','Tamir et','VazgeÃ§','Sabret','DolaÅŸ','Uzat','Dinlen','FÄ±rÃ§ala','Oyna','BaÄŸÄ±r','TÄ±rman','Boya','HÄ±zlan','YavaÅŸla','Koru','Hisset','TeÅŸekkÃ¼r et','KahvaltÄ± yap','Spor yap'];
            const personKeys = ['Ben','Sen','O','Biz','Siz','Onlar'];

            for(let i=0; i<100; i++) {
                let r = basePool[i % basePool.length];
                let pKey = personKeys[i % 6];
                let ans = getLogic(r, pKey, currentModule);
                
                // Fetch or generate unique scenario
                let info = verbContexts[r] || {scen: {tr: `${r} eylemi hakkÄ±nda bir hikaye. Her ÅŸey yolunda gidecek.`, en: `A story about the action of ${r}. Everything will be fine.`, fa: `Ø¯Ø§Ø³ØªØ§Ù†ÛŒ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø¹Ù…Ù„ ${r}. Ù‡Ù…Ù‡ Ú†ÛŒØ² Ø®ÙˆØ¨ Ù¾ÛŒØ´ Ø®ÙˆØ§Ù‡Ø¯ Ø±ÙØª.`}};
                
                items.push({
                    r: r, m: (info[sourceLang] || r) + " (Verb)", p: pKey, ans: ans, 
                    hint: generateDetailedHint(r, pKey, currentModule, ans),
                    sample: info.scen.tr, sampleT: info.scen[sourceLang] || info.scen.en
                });
            }
            load();
        }

        window.fkTab = function(t) {
            ['academy', 'quiz', 'list', 'auth'].forEach(s => { const el = document.getElementById('sec-'+s); if(el) el.style.display = 'none'; });
            document.getElementById('sec-'+t).style.display = 'block';
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            if(t === 'list') renderList();
        };

        window.move = function(d) { cur=(cur+d+100)%100; load(); };
        
        function load() {
            const q = items[cur];
            const t = i18n[sourceLang] || i18n['en'];
            const pNames = t.personNames || i18n['en'].personNames;
            const pn = pNames[q.p] || q.p;

            document.getElementById('module-title-ui').innerText = t[currentModule] || currentModule;
            document.getElementById('v-root').innerText = q.r.toUpperCase();
            document.getElementById('v-mean').innerText = `(${q.m})`;
            document.getElementById('v-pers').innerText = `${q.p.toUpperCase()} (${pn})`;
            document.getElementById('fk-info').innerText = `${t.step || "Step"} ${cur+1} / 100`;
            document.getElementById('fk-input').value = ""; document.getElementById('fk-input').className = "";
            document.getElementById('v-expl').style.display = 'none';
            document.getElementById('sample-tr').innerText = q.sample;
            document.getElementById('sample-target').innerText = q.sampleT;
            
            document.getElementById('sample-tr').onclick = () => fkSpeak(q.sample, 'tr-TR');
            document.getElementById('v-root').onclick = () => fkSpeak(q.r, 'tr-TR');
        }

        window.toggleHint = function() {
            const e = document.getElementById('v-expl'); const q = items[cur];
            e.innerText = q.hint;
            const isVisible = e.style.display === 'block';
            e.style.display = isVisible ? 'none' : 'block';
            if (!isVisible && sourceLang !== 'fa' && sourceLang !== 'ar') fkSpeak(q.hint, sourceLang);
        };

        window.check = function() {
            if(document.getElementById('fk-input').value.trim().toLowerCase() === items[cur].ans.toLowerCase()) {
                score+=10; document.getElementById('fk-score').innerText = `${(i18n[sourceLang]||i18n['en']).score}: ${score}`;
                document.getElementById('fk-input').className = "correct";
                fkSpeak(items[cur].ans, 'tr-TR');
            } else document.getElementById('fk-input').className = "wrong";
        };

        window.reveal = function() {
            document.getElementById('fk-input').value = items[cur].ans;
            fkSpeak(items[cur].ans, 'tr-TR');
        };

        function renderList() {
            const b = document.getElementById('list-body'); b.innerHTML = "";
            items.forEach((q, i) => {
                b.innerHTML += `<tr><td>${i+1}</td><td style="color:var(--accent-root);font-weight:bold">${q.r}</td><td>${q.m}</td><td dir="ltr">${q.ans}</td><td><button onclick="fkSpeak('${q.ans}')">ğŸ”Š</button></td></tr>`;
            });
        }

        window.speechSynthesis.onvoiceschanged = () => window.speechSynthesis.getVoices();
        changeSourceLang('en');
        switchModule('past');
    })();
    </script>
</body>
</html>
